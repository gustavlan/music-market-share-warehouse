# music-market-share-warehouse

This project establishes a data engineering pipeline designed to estimate the market share of major music record labels using alternative data sources. The objective is to map daily streaming volumes from Spotify top charts to their respective parent corporate entities, such as Universal Music Group, Sony Music Entertainment, and Warner Music Group. This infrastructure addresses the lack of direct ownership metadata in standard streaming API responses by synthesizing chart data with a recursive corporate hierarchy derived from the MusicBrainz database.

The technical architecture is built as a containerized platform using Docker to ensure reproducibility across environments. Orchestration is handled by Apache Airflow, which manages daily ingestion workflows. The extraction layer utilizes Python scripts equipped with Playwright to scrape daily global stream counts from Kworb.net, bypassing the limitations of the official Spotify API regarding raw stream counts. These extracts are stored as Parquet files in a local data lake.

For reference data, the project ingests the complete MusicBrainz label database via bulk JSON dumps. Storage and query processing are managed by DuckDB, chosen for its efficiency with analytical queries on local files. Transformations are defined and executed using dbt. The transformation logic includes a raw staging layer, an intermediate layer that unnests complex JSON relationships, and a final dimensional layer. A key component of this logic is a recursive SQL common table expression that traverses the label ownership tree to map subsidiary imprints up to their ultimate parent conglomerates.

Future development will focus on visualizing the aggregated insights through a dedicated Streamlit dashboard, providing an interface to track market share trends over time. There are plans to incorporate a data science module to forecast future market share shifts based on historical streaming velocity. Additionally, the architecture allows for migration from local storage to cloud-based object storage and data warehousing solutions to scale with growing data volumes.
